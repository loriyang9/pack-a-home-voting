<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>「打包一個家」防災臨時生活創新設計</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500&family=Shippori+Mincho:wght@500;700&display=swap"
        rel="stylesheet">
    <style>
        /* 侘寂風格 - 紙/墨/苔 */
        :root {
            --bg: #F8F6F2;
            /* 暖紙色 */
            --text: #2A2522;
            /* 墨茶色 */
            --text-muted: #6F6660;
            /* 次要文字灰茶 */
            --accent: #5E6B60;
            /* 灰苔綠 */
            --border: rgba(42, 37, 34, .12);
            /* 超淡墨線 */
            --card: #FFFEFA;
            /* 紙白 */
            --radius: 8px;
            /* 便利貼紙色 */
            --paper-1: #FBF3E6;
            --paper-2: #F1F3EF;
            --paper-3: #F4EEE7;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Noto Sans TC', sans-serif;
            margin: 0;
            padding-bottom: 40px;
            line-height: 1.85;
        }

        h1,
        h2 {
            font-family: 'Shippori Mincho', serif;
            text-align: center;
            line-height: 1.3;
            letter-spacing: 0.02em;
        }

        h1 {
            margin-top: 30px;
            color: var(--text);
            font-size: 1.6rem;
        }

        h2 {
            font-size: 1.15rem;
            color: var(--text-muted);
            margin-bottom: 24px;
            font-weight: 500;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* 限制內容寬度以保持閱讀性（除了便利貼牆） */
        #page-vote>h1,
        #page-vote>.intro-text,
        #page-vote>.card,
        #page-vote>.btn,
        #page-feedback>* {
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .card {
            background: var(--card);
            padding: 24px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            box-shadow: 0 2px 8px rgba(42, 37, 34, .04);
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin: 15px 0 8px;
            font-weight: 500;
            font-size: 0.95rem;
        }

        select,
        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--bg);
            font-size: 1rem;
            box-sizing: border-box;
            color: var(--text);
        }

        textarea {
            min-height: 100px;
            resize: none;
        }

        /* 按鈕 - 霧面紙卡感 */
        .btn {
            display: block;
            width: 100%;
            padding: 14px 20px;
            background: var(--accent);
            color: #FAFAF8;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 15px;
            box-shadow: 0 1px 2px rgba(42, 37, 34, .1);
            transition: transform 0.15s ease, box-shadow 0.15s ease;
        }

        .btn:hover {
            transform: scale(0.98);
            box-shadow: 0 0 0 rgba(42, 37, 34, .05);
        }

        .btn:active {
            transform: scale(0.96);
        }

        .btn:disabled {
            background: rgba(42, 37, 34, .25);
            color: rgba(255, 255, 255, .7);
            cursor: not-allowed;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--accent);
            color: var(--accent);
            box-shadow: none;
        }

        .btn-outline:hover {
            background: rgba(94, 107, 96, .06);
        }

        /* 作品多選 Checkbox */
        .work-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            margin-bottom: 12px;
            cursor: pointer;
            transition: 0.2s;
            background: var(--card);
        }

        .work-item.selected {
            border-color: var(--accent);
            background: rgba(94, 107, 96, .08);
        }

        .work-item input {
            margin-right: 12px;
            transform: scale(1.2);
        }

        /* 家庭多選 Chips - 印章感 */
        .chip-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .chip {
            padding: 8px 18px;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 0.9rem;
            cursor: pointer;
            background: var(--card);
            color: var(--text-muted);
            transition: all 0.2s ease;
        }

        .chip:hover {
            border-color: var(--accent);
        }

        .chip.active {
            background: rgba(94, 107, 96, .06);
            color: var(--text);
            border: 1.5px solid var(--accent);
            font-weight: 500;
        }

        /* 投票統計長條圖 */
        .stats-section {
            margin: 20px 0;
        }

        .bar-item {
            margin-bottom: 16px;
        }

        .bar-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 0.9rem;
        }

        .bar-label .name {
            font-weight: 500;
        }

        .bar-label .count {
            color: var(--accent);
            font-weight: 600;
        }

        .bar-track {
            background: rgba(42, 37, 34, .06);
            border-radius: 6px;
            height: 20px;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .bar-fill {
            height: 100%;
            background: var(--accent);
            border-radius: 5px;
            transition: width 0.6s ease;
            min-width: 2px;
            width: 0%;
            transition-delay: var(--delay, 0s);
        }

        /* 便利貼牆 */
        .wall-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }

        @media (min-width: 768px) {
            .wall-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .sticky {
            background: var(--paper-1);
            padding: 16px;
            border-radius: 3px;
            font-size: 0.9rem;
            box-shadow: 0 1px 3px rgba(42, 37, 34, .06);
            cursor: pointer;
            border-left: 3px solid var(--border);
            /* 動畫效果 */
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .sticky.visible {
            opacity: 1;
            transform: translateY(0) rotate(0deg);
        }

        /* 便利貼微旋轉 - 手貼感 */
        .sticky:nth-child(6n+1) {
            background: var(--paper-1);
        }

        .sticky:nth-child(6n+1).visible {
            transform: rotate(-0.3deg);
        }

        .sticky:nth-child(6n+2) {
            background: var(--paper-2);
        }

        .sticky:nth-child(6n+2).visible {
            transform: rotate(0.2deg);
        }

        .sticky:nth-child(6n+3) {
            background: var(--paper-3);
        }

        .sticky:nth-child(6n+3).visible {
            transform: rotate(-0.15deg);
        }

        .sticky:nth-child(6n+4) {
            background: var(--paper-1);
        }

        .sticky:nth-child(6n+4).visible {
            transform: rotate(0.35deg);
        }

        .sticky:nth-child(6n+5) {
            background: var(--paper-2);
        }

        .sticky:nth-child(6n+5).visible {
            transform: rotate(-0.25deg);
        }

        .sticky:nth-child(6n+6) {
            background: var(--paper-3);
        }

        .sticky:nth-child(6n+6).visible {
            transform: rotate(0.4deg);
        }

        /* 段落間距 */
        .card p {
            margin-bottom: 1.2em;
        }

        .card p:last-child {
            margin-bottom: 0;
        }

        /* Modal - 柔光紙盒 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(42, 37, 34, 0.25);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            justify-content: center;
            align-items: center;
            padding: 20px;
            z-index: 99;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: var(--card);
            padding: 28px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            box-shadow: 0 4px 20px rgba(42, 37, 34, 0.1);
            width: 100%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            box-sizing: border-box;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* intro 文字區塊 */
        .intro-text {
            margin-bottom: 30px;
            line-height: 1.8;
            text-align: justify;
            color: #555;
            font-size: 0.95rem;
        }

        .intro-text p {
            margin-bottom: 15px;
        }

        .intro-text p:last-child {
            margin-bottom: 0;
        }

        /* 分隔線 */
        .divider {
            border: 0;
            border-top: 1px solid #EEE;
            margin: 40px 0;
        }

        .divider--modal {
            border: 0;
            border-top: 1px solid #EEE;
            margin: 15px 0;
        }

        /* modal 內文字 */
        .modal-title {
            margin-top: 0;
        }

        .modal-meta {
            color: #888;
            font-size: 0.9rem;
        }

        .modal-text {
            white-space: pre-wrap;
        }

        /* 置中載入/提示文 */
        .center-hint {
            text-align: center;
            color: #999;
            padding: 20px;
        }

        .grid-full {
            grid-column: 1 / -1;
        }

        /* 便利貼內容 */
        .sticky-title {
            color: #6D8494;
            font-size: 0.85rem;
        }

        .sticky-preview {
            margin-top: 5px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 6;
            -webkit-box-orient: vertical;
        }

        /* 產品介紹頁特定樣式 */
        #page-products {
            padding-bottom: 60px;
        }

        .product-section {
            margin-bottom: 80px;
            scroll-margin-top: 20px;
        }

        .product-header {
            margin-bottom: 24px;
        }

        .product-title {
            font-size: 1.4rem;
            color: var(--text);
            margin: 0 0 8px 0;
            font-family: 'Shippori Mincho', serif;
        }

        .product-subtitle {
            font-size: 1rem;
            color: var(--accent);
            font-weight: 500;
        }



        .product-image-container {
            position: relative;
            width: 100%;
            margin-bottom: 24px;
        }

        .product-image {
            width: 100%;
            height: auto;
            max-height: 100vh;
            object-fit: contain;
            display: block;
            margin: 0 auto;
        }

        .info-grid {
            display: grid;
            gap: 20px;
            font-size: 0.95rem;
        }

        .info-label {
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 6px;
            display: block;
        }

        .info-content {
            color: var(--text);
            line-height: 1.7;
            white-space: pre-wrap;
        }

        .feature-list {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }

        @media (min-width: 600px) {
            .feature-list {
                grid-template-columns: 1fr 1fr;
            }
        }

        .feature-item {
            background: rgba(94, 107, 96, .05);
            padding: 12px 16px;
            border-radius: 6px;
            border-left: 3px solid var(--accent);
            font-size: 0.9rem;
        }

        .feature-title {
            display: block;
            font-weight: bold;
            text-align: center;
            margin-bottom: 6px;
            font-size: 1rem;
            color: var(--text);
        }

        .feature-desc {
            display: block;
            text-align: left;
        }

        .back-nav {
            margin-bottom: 20px;
        }

        /* Responsive Side-by-Side Product Layout */
        @media (min-width: 900px) {
            .product-section {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 40px;
                /* align-items: stretch; is default, which we want */
            }

            .product-header {
                grid-column: 1 / -1;
                /* Title spans full width */
                margin-bottom: 24px;
            }

            .product-image-container {
                margin-bottom: 0;
                position: relative;
                /* Container matches row height (from card) */
                height: auto;
                /* Allow it to be sized by grid stretch */
            }

            /* Adjust image height for side-by-side view */
            .product-image {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                max-height: none;
                object-fit: cover;
                transition: opacity 0.3s ease;
            }

            .product-image.real-photo {
                opacity: 0;
                /* Hidden by default */
                z-index: 2;
                /* On top of sketch */
            }

            /* Desktop Hover or JS class */
            .product-image-container:hover .product-image.real-photo,
            .product-image-container.show-real .product-image.real-photo {
                opacity: 1;
                /* Show on hover or class */
            }

            .product-image-container:hover .product-image:not(.real-photo),
            .product-image-container.show-real .product-image:not(.real-photo) {
                opacity: 0;
                /* Hide sketch on hover or class */
            }

        }

        /* Mobile/Tablet */
        @media (max-width: 899px) {
            .product-image-container {
                position: relative;
                padding-bottom: 0;
                height: auto;
                overflow: visible;
                /* Remove :active behavior, rely on JS */
            }

            .product-image {
                /* Reset position for natural flow logic */
                width: 100%;
                height: auto;
                object-fit: contain;
                /* Ensure full image is seen */
                transition: opacity 0.3s ease;
                display: block;
            }

            /* Sketch drives the layout height */
            .product-image:not(.real-photo) {
                position: relative;
            }

            /* Real photo overlays the sketch */
            .product-image.real-photo {
                position: absolute;
                top: 0;
                left: 0;
                height: 100%;
                /* Match height of sketch */
                opacity: 0;
                z-index: 2;
            }

            /* JS Toggled State */
            .product-image-container.show-real .product-image.real-photo {
                opacity: 1;
            }

            .product-image-container.show-real .product-image:not(.real-photo) {
                opacity: 0;
            }
        }
    </style>
</head>

<body>

    <div class="container">

        <!-- 產品介紹頁 (預設隱藏) -->
        <div id="page-products" class="page">
            <div class="back-nav">
                <button class="btn btn-outline" onclick="backToVote()" style="width: auto; padding: 8px 16px;">
                    ← 前往投票
                </button>
            </div>

            <!-- 復刻首頁標題區 -->
            <h1>「打包一個家」防災臨時生活創新設計</h1>
            <div class="intro-text" style="text-align: center;">
                <p>請參觀本屆參選的四項作品，試想在緊急災難時刻，你會希望避難時能使用到哪項作品呢？</p>
            </div>

            <hr class="divider">

            <!-- 產品 1 -->
            <div class="product-section" id="prod-taipei1">
                <div class="product-header">
                    <h3 class="product-title">助眠罩</h3>
                    <div class="product-subtitle">避難時的遮光好眠設計</div>
                </div>
                <!-- Carousel Container -->
                <div class="product-image-container" id="carousel-taipei1">
                    <!-- Default Sketch -->
                    <img src="Pic/prod_taipei1.jpg" alt="助眠罩產品圖 (素描)" class="product-image">
                    <!-- Hover Real Photo -->
                    <img src="Pic/prod_taipei1_real.jpg" alt="助眠罩實體圖" class="product-image real-photo">
                </div>

                <div class="card">
                    <div class="info-grid">
                        <div>
                            <span class="info-label">設計師</span>
                            <div class="info-content">張幻柔、張蓴、莊進發</div>
                        </div>
                        <div>
                            <span class="info-label">現況問題</span>
                            <div class="info-content" style="white-space: normal;">
                                <ol style="padding-left: 20px; margin: 0;">
                                    <li>高敏人在睡眠時需要密閉且完全遮蔽光線的空間</li>
                                    <li>睡眠時的隱密性</li>
                                    <li>光線太強影響休息</li>
                                    <li>可調節光線強弱</li>
                                </ol>
                            </div>
                        </div>
                        <div>
                            <span class="info-label">設計特點</span>
                            <ul class="feature-list">
                                <li class="feature-item">
                                    <div class="feature-title">特點1 手提把</div>
                                    <div class="feature-desc">可使用左右兩側提把移動，不使用時可以將紙板蓋上遮擋光線。</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點2 透氣孔</div>
                                    <div class="feature-desc">後側透氣孔可依照喜好需求掀開，始內部透氣。</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點3 牛皮紙遮光罩</div>
                                    <div class="feature-desc">上蓋使用牛皮紙材質，達到輕量化，輕鬆掀開坐起身或躺下動作。</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點4 光線調節</div>
                                    <div class="feature-desc">上蓋牛皮紙內部有滑動圓孔，可以依照喜好做光線強弱的控制。</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點5 隱密舒適無壓迫感</div>
                                    <div class="feature-desc">依照人體工學量測設計，提供高敏人或對光線敏感者一個舒適的休息空間。</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點6 攤平運輸</div>
                                    <div class="feature-desc">壓線設計，讓整個產品可以攤平，利於存放和運輸。</div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <hr class="divider">

            <!-- 產品 2 -->
            <div class="product-section" id="prod-taipei2">
                <div class="product-header">
                    <h3 class="product-title">靜心屏</h3>
                    <div class="product-subtitle">在緊急避難環境劃出一隅私人空間</div>
                </div>
                <!-- Carousel Container -->
                <!-- Carousel Container -->
                <div class="product-image-container" id="carousel-taipei2">
                    <img src="Pic/prod_taipei2.jpg" alt="靜心屏產品圖 (素描)" class="product-image">
                    <img src="Pic/prod_taipei2_real.jpg" alt="靜心屏實體圖" class="product-image real-photo">
                </div>

                <div class="card">
                    <div class="info-grid">
                        <div>
                            <span class="info-label">設計師</span>
                            <div class="info-content">吳致勳、王昭怡、黃千峻</div>
                        </div>
                        <div>
                            <span class="info-label">現況問題</span>
                            <div class="info-content" style="white-space: normal;">
                                <ol style="padding-left: 20px; margin: 0;">
                                    <li>毫無隱私：臨時安置的開放式空間無法滿足更衣、哺乳與個人生理行為所需的基本遮蔽，影響使用者的尊嚴與身體舒適度，亦可能使人因被迫暴露於他人視線中而產生壓力、焦慮或自我壓抑的行為。
                                    </li>
                                    <li>心神不寧：高密度共處與持續的感官刺激，使部分使用者（包含一般大眾與心智障礙者）難以調節情緒，迫切需要一個可短暫獨處、穩定心理狀態的個人空間。</li>
                                    <li>恐慌蔓延：當民眾因突發刺激在開放安置空間中出現情緒失控行為時，缺乏即時安撫與隔離空間，容易使不安情緒暴露並擴散，影響周遭民眾的心理安全與整體空間秩序。</li>
                                </ol>
                            </div>
                        </div>
                        <div>
                            <span class="info-label">設計特點</span>
                            <ul class="feature-list">
                                <li class="feature-item">
                                    <div class="feature-title">特點1 全遮擋</div>
                                    <div class="feature-desc">阻擋極大部分縫隙</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點2 多元組合</div>
                                    <div class="feature-desc">依照想要組裝的尺寸自由拼接</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點3 攤平收納</div>
                                    <div class="feature-desc">每個零件皆可攤平收納</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點4 快速組裝</div>
                                    <div class="feature-desc">在熟悉操作後可以在短時間內組裝完成</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點5 紙卡扣鎖的門</div>
                                    <div class="feature-desc">防呆設計僅能從內部上鎖</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點6 天花板</div>
                                    <div class="feature-desc">可調整透光度的天花板</div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <hr class="divider">

            <!-- 產品 3 -->
            <div class="product-section" id="prod-suzhou1">
                <div class="product-header">
                    <h3 class="product-title">緊急避難應變嬰兒床</h3>
                    <div class="product-subtitle">孩童與毛孩避難時的安心角落</div>
                </div>
                <!-- Carousel Container -->
                <!-- Carousel Container -->
                <div class="product-image-container" id="carousel-suzhou1">
                    <img src="Pic/prod_suzhou1.jpg" alt="避難嬰兒床產品圖 (素描)" class="product-image">
                    <img src="Pic/prod_suzhou1_real.jpg" alt="避難嬰兒床實體圖" class="product-image real-photo">
                </div>

                <div class="card">
                    <div class="info-grid">
                        <div>
                            <span class="info-label">設計師</span>
                            <div class="info-content">宋永波、李風利、劉晨</div>
                        </div>
                        <div>
                            <span class="info-label">現況問題</span>
                            <div class="info-content" style="white-space: normal;">
                                <ol style="padding-left: 20px; margin: 0;">
                                    <li>帶著嬰兒和毛孩的家長不知道如何安置嬰兒和寵物</li>
                                    <li>救援運輸紙箱，到現場後，一般都是廢紙，如何再利用給嬰兒和毛孩使用。</li>
                                    <li>嬰兒安置的嬰兒床和寵物臨時安置籠子如何簡單快速成型</li>
                                </ol>
                            </div>
                        </div>
                        <div>
                            <span class="info-label">設計特點</span>
                            <ul class="feature-list">
                                <li class="feature-item">
                                    <div class="feature-title">特點1 運輸箱</div>
                                    <div class="feature-desc">
                                        尺寸700*500*400mm，全封閉運輸箱，可以整合嬰兒短期需要的用品和食物。可以運輸其他用品。箱子2邊有手提孔可以拆開，雙手更好的搬運箱子</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點2 150mm嬰兒床</div>
                                    <div class="feature-desc">
                                        箱子裡面的折疊墊輕鬆打開後，墊在下面將床抬高150mm，阻斷了地面的髒汙直接接觸嬰兒。嬰兒床兩邊也有兩個新的把手，當床的時候也很好拿取</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點3 0mm嬰兒床</div>
                                    <div class="feature-desc">將折疊墊拿出來，再把紙板往裡對折行成新的無高度嬰兒床-特點是：還保留150mm高度側面，保護嬰兒睡著後不會翻滾出來
                                    </div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點4 寵物臨時安置籠</div>
                                    <div class="feature-desc">將箱子的5個帶孔卡片往裡一按，就會出現5個透氣孔，箱子2邊有卡扣，可以卡住10kg以內的動物臨時不能跑出來
                                    </div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點5 嬰兒臨時玩具</div>
                                    <div class="feature-desc">箱子的5個透氣孔的卡片掉下來後，可以用繩子串起來掛在嬰兒床上當轉移視線的玩具。卡片形狀各異，有小熊小貓小狗等
                                    </div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點6 救災結束後當寵物窩</div>
                                    <div class="feature-desc">救災結束後，箱子既可以當寵物運輸箱，也可以帶回家折疊成嬰兒床給寵物當一個永久的家</div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <hr class="divider">

            <!-- 產品 4 -->
            <div class="product-section" id="prod-suzhou2">
                <div class="product-header">
                    <h3 class="product-title">小憩一隅</h3>
                    <div class="product-subtitle">單一元件組裝成百變避難家具</div>
                </div>
                <!-- Carousel Container -->
                <!-- Carousel Container -->
                <div class="product-image-container" id="carousel-suzhou2">
                    <img src="Pic/prod_suzhou2.jpg" alt="模組化家具產品圖 (素描)" class="product-image">
                    <img src="Pic/prod_suzhou2_real.jpg" alt="模組化家具實體圖" class="product-image real-photo">
                </div>

                <div class="card">
                    <div class="info-grid">
                        <div>
                            <span class="info-label">設計師</span>
                            <div class="info-content">宋永波、王建、嵇磊磊、黃榮凱</div>
                        </div>
                        <div>
                            <span class="info-label">現況問題</span>

                            <div class="info-content" style="white-space: normal;">
                                <ol style="padding-left: 20px; margin: 0;">
                                    <li style="margin-bottom: 4px;">
                                        <strong>缺少休息設施：</strong>受災群眾休息時，若直接躺地面上，易受冷生病，且地面灰塵多，難以保持乾淨，同時在人員走動時，易發生踩踏等安全問題；而席地而坐，易產生疲勞，出現久坐後起立困難等問題。
                                    </li>
                                    <li style="margin-bottom: 4px;">
                                        <strong>缺乏舒適性：</strong>現有的避難床採用硬質塑膠材料，舒適性有所欠缺。
                                    </li>
                                    <li style="margin-bottom: 4px;">
                                        <strong>產品功能性單一性：</strong>現用的凳子、床功能性單一，缺乏不同時段、不同需求的可變性。
                                    </li>
                                    <li>
                                        <strong>成本高、生產週期長：</strong>單一功能避難家具生產成本高、生產週期長，需要一定備貨量，缺乏緊急應變能力。
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div>
                            <span class="info-label">設計特點</span>
                            <ul class="feature-list">
                                <li class="feature-item">
                                    <div class="feature-title">特點1 可變性</div>
                                    <div class="feature-desc">凳、桌、床等形態可隨意轉換。</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點2 一般性</div>
                                    <div class="feature-desc">969*380mm的BC楞紙，符合包裝廠常備紙規格。</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點3 舒適性</div>
                                    <div class="feature-desc">BC楞紙具有一定的可壓縮性，舒適性較好。</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點4 週期短</div>
                                    <div class="feature-desc">製版→紮盒，生產週期短。</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點5 成本低</div>
                                    <div class="feature-desc">全紙、單一結構，成本低。</div>
                                </li>
                                <li class="feature-item">
                                    <div class="feature-title">特點6 應用廣</div>
                                    <div class="feature-desc">可用作辦公、用餐、睡覺、輔助支撐等。</div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="back-nav" style="text-align: center; margin-top: 40px;">
                <button class="btn" onclick="backToVote()">前往投票</button>
            </div>
        </div>

        <div id="page-vote" class="page active">
            <h1>「打包一個家」防災臨時生活創新設計</h1>
            <div class="intro-text">
                <p>
                    「打包一個家」是富迪印刷自2022啟動的永續計畫，運用集團包裝結構設計與材質創新的實力，投入於具永續價值的社會議題中。今年我們的設計團隊與製造生產線，正在協助災後避難收容過程中，能有更安全、安心、易用的安置工具。
                </p>
                <p>我們相信跨領域的協作始能激發創新，因此在這個階段，期待能邀請你成為產品測試的一員，藉由你的自身經驗協助團隊了解使用者對於目前產品的觀點。</p>
            </div>
            <div class="card">
                <p>請參觀四項作品，試想在緊急災難時刻，你會想用哪一個呢？（可多選）</p>
                <div id="works-list">
                    <label class="work-item" onclick="toggleStyle(this)">
                        <input type="checkbox" name="work" value="Taipei1">
                        <span>助眠罩：避難時的遮光好眠設計</span>
                    </label>
                    <label class="work-item" onclick="toggleStyle(this)">
                        <input type="checkbox" name="work" value="Taipei2">
                        <span>靜心屏：在緊急避難環境劃出一隅私人空間</span>
                    </label>
                    <label class="work-item" onclick="toggleStyle(this)">
                        <input type="checkbox" name="work" value="Suzhou1">
                        <span>緊急避難應變嬰兒床：孩童與毛孩避難時的安心角落</span>
                    </label>
                    <label class="work-item" onclick="toggleStyle(this)">
                        <input type="checkbox" name="work" value="Suzhou2">
                        <span>模組化避難家具：單一元件組裝成百變家具</span>
                    </label>
                </div>
            </div>
            <button class="btn" onclick="goStep2()">下一步：填寫回饋</button>
            <button class="btn btn-outline" onclick="viewProductIntros()">看四個產品簡介</button>

            <hr class="divider">

            <h2>目前票選情況</h2>
            <div id="stats-container" class="stats-section">
                <div class="center-hint">統計載入中...</div>
            </div>

            <hr class="divider">

            <h2>大家的回饋</h2>
            <div id="wall-container" class="wall-grid">
                <div class="center-hint grid-full">載入中...</div>
            </div>
        </div>

        <div id="page-feedback" class="page">
            <h2>想和設計團隊說什麼呢？</h2>

            <div class="card">
                <label>您的年齡區間</label>
                <select id="input-age">
                    <option value="">請選擇</option>
                    <option value="18歲以下">18歲以下</option>
                    <option value="19-29歲">19-29歲</option>
                    <option value="30-39歲">30-39歲</option>
                    <option value="40-49歲">40-49歲</option>
                    <option value="50-64歲">50-64歲</option>
                    <option value="65歲以上">65歲以上</option>
                </select>

                <label>您家裡有哪些成員？（可多選）</label>
                <div class="chip-group" id="family-group">
                    <div class="chip" onclick="toggleChip(this)" data-val="Single">只有我自己</div>
                    <div class="chip" onclick="toggleChip(this)" data-val="Partner">有伴侶</div>
                    <div class="chip" onclick="toggleChip(this)" data-val="Baby">有嬰孩</div>
                    <div class="chip" onclick="toggleChip(this)" data-val="Pet">有毛孩</div>
                    <div class="chip" onclick="toggleChip(this)" data-val="Elderly">有年長者</div>
                </div>
            </div>

            <div class="card">
                <label>你想對哪一個設計團隊說呢？</label>
                <select id="input-target">
                    <option value="Taipei1">助眠罩：避難時的遮光好眠設計</option>
                    <option value="Taipei2">靜心屏：在緊急避難環境劃出一隅私人空間</option>
                    <option value="Suzhou1">緊急避難應變嬰兒床：孩童與毛孩避難時的安心角落</option>
                    <option value="Suzhou2">模組化避難家具：單一元件組裝成百變家具</option>
                </select>

                <label>我想告訴設計團隊...</label>
                <textarea id="input-content" placeholder="請輸入你的經驗或修正建議..."></textarea>
            </div>

            <button type="button" id="btn-submit" class="btn" onclick="submitData(event, false)">送出，看大家回饋</button>
            <button type="button" id="btn-more" class="btn btn-outline"
                onclick="submitData(event, true)">送出，再寫一張</button>
        </div>

    </div>

    <div id="modal" class="modal" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h3 id="m-target" class="modal-title"></h3>
            <p id="m-meta" class="modal-meta"></p>
            <hr class="divider--modal">
            <p id="m-text" class="modal-text"></p>
            <button class="btn btn-outline" onclick="closeModal()">關閉</button>
        </div>
    </div>

    <script>
        // ==========================================
        // 請替換成你部署後的 Web App URL
        // ==========================================
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzlkkoiLozWBEJYNuraISxy5pZakk7pJhLyLHTgWcB_oJZZqFdBjuwPhz1CNdz9OMoO/exec";

        let voteData = { works: [] };
        let hasVoted = false;

        // 產品名稱對照表
        const targetNameMap = {
            "Taipei1": "助眠罩",
            "Taipei2": "靜心屏",
            "Suzhou1": "避難嬰兒床",
            "Suzhou2": "模組化避難家具"
        };

        // API 請求封裝：確保 HTTP 成功且 JSON result 為 success
        async function fetchJsonOrThrow(url, options) {
            const res = await fetch(url, options);

            // Apps Script 有時候 content-type 不漂亮，先用 text 再自己 parse
            const text = await res.text();

            let json = null;
            try { json = JSON.parse(text); } catch (e) { }

            // 1) HTTP 層失敗（例如 404/500）
            if (!res.ok) {
                throw new Error(`HTTP ${res.status}`);
            }

            // 2) 有 JSON 而且後端用 result 表達成功/失敗
            if (json && typeof json === "object" && "result" in json && json.result !== "success") {
                throw new Error(json.message || "Server returned failure");
            }

            // 3) 有 JSON 就回 JSON，沒有就回文字
            return json ?? text;
        }

        // 初始化：載入便利貼牆和統計數據
        window.onload = function () {
            loadWall();
            loadStats();

            // 如果有 page=wall 參數，可以考慮自動滾動到牆的位置 (可選)
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('page') === 'wall') {
                const wall = document.getElementById("wall-container");
                if (wall) wall.scrollIntoView({ behavior: 'smooth' });
            }
        };

        // 讀取投票統計
        async function loadStats() {
            const container = document.getElementById("stats-container");
            try {
                const json = await fetchJsonOrThrow(SCRIPT_URL + "?action=stats");
                if (json.result !== "success" || !json.data) {
                    container.innerHTML = "<p class='center-hint'>暫無統計資料</p>";
                    return;
                }

                const data = json.data;
                const items = [
                    { key: "Taipei1", name: targetNameMap["Taipei1"], count: data.Taipei1 || 0 },
                    { key: "Taipei2", name: targetNameMap["Taipei2"], count: data.Taipei2 || 0 },
                    { key: "Suzhou1", name: targetNameMap["Suzhou1"], count: data.Suzhou1 || 0 },
                    { key: "Suzhou2", name: targetNameMap["Suzhou2"], count: data.Suzhou2 || 0 }
                ];

                // 找出最大值來計算百分比
                const maxCount = Math.max(...items.map(i => i.count), 1);

                // 先用 width: 0 渲染，之後再動畫
                container.innerHTML = items.map((item, index) => {
                    const percent = (item.count / maxCount) * 100;
                    return `
                            <div class="bar-item">
                                <div class="bar-label">
                                    <span class="name">${item.name}</span>
                                    <span class="count">${item.count} 票</span>
                                </div>
                                <div class="bar-track">
                                    <div class="bar-fill" data-percent="${percent}" style="--delay: ${index * 0.1}s;"></div>
                                </div>
                            </div>
                        `;
                }).join("");

                // 使用 Intersection Observer 偵測滾動進入畫面
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            // 進入畫面時觸發動畫
                            container.querySelectorAll('.bar-fill').forEach(bar => {
                                const percent = bar.getAttribute('data-percent');
                                bar.style.width = percent + '%';
                            });
                            observer.disconnect(); // 只執行一次
                        }
                    });
                }, { threshold: 0.3 });

                observer.observe(container);
            } catch (err) {
                console.error("Stats fetch error:", err);
                container.innerHTML = "<p class='center-hint'>統計載入失敗</p>";
            }
        }

        // UI 互動：作品勾選
        function toggleStyle(label) {
            setTimeout(() => {
                const chk = label.querySelector("input");
                label.classList.toggle("selected", chk.checked);
            }, 10);
        }

        // UI 互動：家庭標籤 (Chips)
        function toggleChip(el) {
            el.classList.toggle("active");
        }

        // 步驟 1 -> 步驟 2
        function goStep2() {
            const checked = document.querySelectorAll('input[name="work"]:checked');
            if (checked.length === 0) { alert("請至少選擇一項產品"); return; }

            voteData.works = Array.from(checked).map(c => c.value).join(","); // 結果如 "Taipei1,Suzhou2"

            document.getElementById("page-vote").classList.remove("active");
            document.getElementById("page-feedback").classList.add("active");
            window.scrollTo(0, 0);
        }

        // 送出資料
        function submitData(arg1, arg2) {
            // Robust argument handling
            let evt = null;
            let isMore = false;

            // Check if first arg is an Event object (has preventDefault)
            if (arg1 && typeof arg1.preventDefault === 'function') {
                evt = arg1;
                isMore = arg2;
            } else {
                // Legacy support or argument mismatch
                isMore = arg1;
            }

            if (evt) evt.preventDefault(); // Stop form submission / reload

            // Double check: if explicit button ID is found, trust it
            if (evt && evt.currentTarget && evt.currentTarget.id === "btn-more") {
                isMore = true;
            } else if (evt && evt.currentTarget && evt.currentTarget.id === "btn-submit") {
                isMore = false;
            }

            const age = document.getElementById("input-age").value;
            const target = document.getElementById("input-target").value;
            const content = document.getElementById("input-content").value;

            // 收集家庭標籤 (Chips)
            const familyChips = document.querySelectorAll('#family-group .chip.active');
            const family = Array.from(familyChips).map(c => c.dataset.val).join(",");

            if (!age) { alert("請選擇年齡"); return; }
            if (!content) { alert("請跟設計團隊說說話"); return; }

            const btn1 = document.getElementById("btn-submit");
            const btn2 = document.getElementById("btn-more");

            // 傳送時的統一樣式：灰底、白字、無邊框
            const disabledStyle = { background: '#CCC', color: '#fff', border: 'none' };

            // 根據點擊的按鈕顯示傳送狀態
            if (isMore) {
                btn2.innerText = "傳送中...";
            } else {
                btn1.innerText = "傳送中...";
            }

            // 兩個按鈕都套用 disabled 樣式
            btn1.style.background = disabledStyle.background;
            btn1.style.color = disabledStyle.color;
            btn1.style.border = disabledStyle.border;
            btn2.style.background = disabledStyle.background;
            btn2.style.color = disabledStyle.color;
            btn2.style.border = disabledStyle.border;

            btn1.disabled = true; btn2.disabled = true;

            const requests = [];

            // fetch 選項，防止重定向問題
            const fetchOptions = {
                method: "POST",
                redirect: "follow"
            };

            // 1. 如果還沒投過票，發送投票數據 (Votes)
            if (!hasVoted) {
                const fd1 = new FormData();
                fd1.append("action", "vote");
                fd1.append("selectedWorks", voteData.works);
                fd1.append("age", age);
                fd1.append("family", family);
                requests.push(fetchJsonOrThrow(SCRIPT_URL, { ...fetchOptions, body: fd1 }));
            }

            // 2. 發送回饋數據 (Feedback)
            const fd2 = new FormData();
            fd2.append("action", "feedback");
            fd2.append("target", target);
            fd2.append("content", content);
            fd2.append("age", age);
            fd2.append("family", family);
            requests.push(fetchJsonOrThrow(SCRIPT_URL, { ...fetchOptions, body: fd2 }));

            // 使用區域變數保存狀態，避免非同步問題
            const stayOnPage = isMore;

            Promise.all(requests).then((results) => {
                hasVoted = true;

                // 恢復按鈕樣式的輔助函式
                function restoreButtonStyles() {
                    btn1.disabled = false;
                    btn2.disabled = false;
                    // 清除所有 inline style，讓 CSS class 生效
                    btn1.style.background = "";
                    btn1.style.color = "";
                    btn1.style.border = "";
                    btn2.style.background = "";
                    btn2.style.color = "";
                    btn2.style.border = "";
                    btn1.innerText = "送出，看大家回饋";
                    btn2.innerText = "送出，再寫一張";
                }

                if (stayOnPage) {
                    // 再寫一張：清空內容，保留個人資料
                    document.getElementById("input-content").value = "";
                    document.getElementById("input-content").focus();

                    // 先恢復按鈕
                    restoreButtonStyles();

                    // 按鈕文字提示（2秒後恢復）
                    btn2.innerText = "送出成功，請繼續填寫";
                    setTimeout(() => {
                        btn2.innerText = "送出，再寫一張";
                    }, 2000);
                } else {
                    // 回到首頁並滾動到牆
                    document.getElementById("page-feedback").classList.remove("active");
                    document.getElementById("page-vote").classList.add("active");

                    // Reset VOTE Page
                    voteData.works = [];
                    hasVoted = false;
                    document.querySelectorAll('input[name="work"]').forEach(chk => {
                        chk.checked = false;
                        chk.parentElement.classList.remove("selected");
                    });

                    // Reset FEEDBACK Page（清空回饋表單）
                    document.getElementById("input-age").value = "";
                    document.getElementById("input-content").value = "";
                    document.getElementById("input-target").value = "Taipei1";
                    document.querySelectorAll('#family-group .chip').forEach(chip => {
                        chip.classList.remove("active");
                    });

                    // 恢復按鈕樣式
                    restoreButtonStyles();

                    loadWall();
                    setTimeout(() => {
                        const wallSection = document.querySelector("#page-vote h2");
                        if (wallSection) wallSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }, 300);
                }
            }).catch(err => {
                console.error(err);
                alert("連線錯誤，請重試");
                btn1.disabled = false; btn2.disabled = false;
                btn1.style.background = ""; btn1.style.color = ""; btn1.style.border = "";
                btn2.style.background = ""; btn2.style.color = ""; btn2.style.border = "";
                btn1.innerText = "送出，看大家回饋";
                btn2.innerText = "送出，再寫一張";
            });
        }

        // 讀取便利貼牆（帶本地快取）
        const WALL_CACHE_KEY = 'wallDataCache';

        function renderWallItems(data, container) {
            container.innerHTML = "";
            if (!data || data.length === 0) {
                container.innerHTML = "<p class='center-hint grid-full'>暫無留言</p>";
                return;
            }
            // 複製並反轉，避免修改原始資料
            [...data].reverse().forEach((item, index) => {
                const targetName = targetNameMap[item.target] || item.target;
                const div = document.createElement("div");
                div.className = "sticky";
                // 設定動畫延遲，每張便利貼差 0.05 秒
                div.style.transitionDelay = (index * 0.05) + "s";

                const title = document.createElement("strong");
                title.className = "sticky-title";
                title.textContent = `我想對 ${targetName} 的設計團隊說`;

                const preview = document.createElement("div");
                preview.className = "sticky-preview";
                preview.textContent = item.content ?? ""; // 關鍵：永遠用 textContent

                div.appendChild(title);
                div.appendChild(preview);

                div.onclick = () => showModal({ ...item, targetName });
                container.appendChild(div);
            });

            // 使用 Intersection Observer 偵測每張便利貼進入畫面
            const stickyObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, { threshold: 0.1 });

            container.querySelectorAll('.sticky').forEach(sticky => {
                stickyObserver.observe(sticky);
            });
        }

        function loadWall() {
            const container = document.getElementById("wall-container");

            // 1. 先嘗試從快取讀取並顯示
            try {
                const cached = localStorage.getItem(WALL_CACHE_KEY);
                if (cached) {
                    const cachedData = JSON.parse(cached);
                    renderWallItems(cachedData, container);
                }
            } catch (e) {
                console.warn("Cache read error:", e);
            }

            // 如果沒有快取，顯示載入中
            if (container.children.length === 0) {
                container.innerHTML = "<div class='center-hint grid-full'>便利貼讀取中...</div>";
            }

            // 2. 在背景抓取最新資料
            fetchJsonOrThrow(SCRIPT_URL + "?action=read")
                .then(json => {
                    if (!json || !json.data) throw new Error("No data");
                    // 3. 更新畫面
                    renderWallItems(json.data, container);

                    // 4. 儲存到快取
                    try {
                        localStorage.setItem(WALL_CACHE_KEY, JSON.stringify(json.data));
                    } catch (e) {
                        console.warn("Cache write error:", e);
                    }
                })
                .catch(err => {
                    console.error("Fetch error:", err);
                    // 如果有快取資料就不顯示錯誤（已經顯示了快取）
                    if (container.children.length === 0 || container.querySelector('.sticky') === null) {
                        container.innerHTML = `<div class='center-hint grid-full' style='color:red;'>
                            讀取失敗<br>
                            <small style="color:#666">${err.message}</small><br>
                            <button type="button" class="btn btn-outline" onclick="loadWall()" style="margin-top:10px; width:auto; display:inline-block; padding: 8px 16px;">重試</button>
                        </div>`;
                    }
                });
        }

        function showModal(item) {
            const targetName = item.targetName || targetNameMap[item.target] || item.target;
            document.getElementById("m-target").innerText = "我想對 " + targetName + " 的設計團隊說";
            // document.getElementById("m-meta").innerText = `${item.age} / ${item.family}`; // 隱藏個資
            document.getElementById("m-text").innerText = item.content;
            document.getElementById("modal").classList.add("show");
        }

        // --- Navigation & Routing ---

        // 1. Core View Logic (DOM Manipulation)
        function renderProductPage() {
            // Prevent re-rendering if already matching (optional optimization, but safe to repeat)
            if (document.getElementById("page-products").classList.contains("active")) return;

            document.getElementById("page-vote").classList.remove("active");
            document.getElementById("page-products").classList.add("active");
            window.scrollTo(0, 0);
            startAutoCycle();
        }

        function renderVotePage() {
            if (document.getElementById("page-vote").classList.contains("active")) return;

            document.getElementById("page-products").classList.remove("active");
            document.getElementById("page-vote").classList.add("active");
            window.scrollTo(0, 0);
            stopAutoCycle();
        }

        // 2. Event Handlers (Click -> URL Update)
        function viewProductIntros() {
            window.location.hash = "products";
        }

        function backToVote() {
            // Use pushState to remove hash cleanly, or just set to empty
            // Setting hash to '' leaves a # usually. 
            // Let's plain set hash to empty string for simplicity in typical static sites.
            window.location.hash = "";

            // Note: setting hash='' triggers hashchange event in most modern browsers.
            // If we want to remove the '#' entirely from URL bar:
            if (history.pushState) {
                history.pushState(null, null, window.location.pathname + window.location.search);
                // pushState does NOT trigger hashchange, so we must call handler manually
                handleRouting();
            }
        }

        // 3. Router
        function handleRouting() {
            const hash = window.location.hash;
            if (hash === "#products") {
                renderProductPage();
            } else {
                renderVotePage(); // Default to vote page
            }
        }

        // 4. Initialization
        window.addEventListener("hashchange", handleRouting);
        window.addEventListener("load", handleRouting);

        // Auto-cycle Logic
        let productIntervals = [];

        function startAutoCycle() {
            // Clear any existing to be safe
            stopAutoCycle();

            // Only run on mobile/tablet (width < 900px) users preferred behavior
            // But the user asked for this feature specifically for "Phone state".
            // We can just run it generally or check width. 
            // Let's check width to avoid annoying desktop users who have hover.
            if (window.innerWidth >= 900) return;

            const containers = document.querySelectorAll('.product-image-container');

            containers.forEach((container) => {
                // Function to toggle class
                const toggleImage = () => {
                    container.classList.toggle('show-real');
                };

                // Start interval
                const intervalId = setInterval(toggleImage, 5000);
                productIntervals.push(intervalId);

                // Interaction Handlers
                // 1. Click to toggle
                container.onclick = (e) => {
                    // Prevent default behaviors if mixed with touch
                    toggleImage();
                    // Reset interval on manual interaction
                    clearInterval(intervalId);
                    // We can't easily restart specific interval inside loop unless we track it
                    // Simplified: Just toggle. The interval is running separately.
                    // Better: Restart this specific interval
                };

                // 2. Long Press / Touch Pause
                // On touch start, clear interval (Pause)
                container.ontouchstart = () => {
                    clearInterval(intervalId);
                };

                // On touch end, resume interval
                // Note: This logic might get tricky if we need to persist the SAME interval variable reference
                // Let's use a more robust approach below
            });

            // Revised robust approach
            setupMobileInteractions();
        }

        function stopAutoCycle() {
            productIntervals.forEach(clearInterval);
            productIntervals = [];
            // Also remove class to reset
            document.querySelectorAll('.product-image-container').forEach(c => c.classList.remove('show-real'));
        }

        function setupMobileInteractions() {
            const containers = document.querySelectorAll('.product-image-container');

            containers.forEach(container => {
                let localInterval;

                const startLocalTimer = () => {
                    clearInterval(localInterval);
                    localInterval = setInterval(() => {
                        container.classList.toggle('show-real');
                    }, 5000);
                    productIntervals.push(localInterval);
                }

                // Start initially
                startLocalTimer();

                // Click: Toggle immediately
                // Use touchend for mobile to avoid 300ms delay, but click is safer for conflict with scroll
                container.onclick = (e) => {
                    container.classList.toggle('show-real');
                    // Reset timer so it doesn't switch right after user clicked
                    startLocalTimer();
                };

                // Touch Start: Pause (Clear Timer)
                container.ontouchstart = () => {
                    clearInterval(localInterval);
                };

                // Touch End: Resume (Start Timer)
                // Note: click fires after touchend. 
                // Logic flow: touchstart (pause) -> touchend (resume) -> click (toggle + reset)
                container.ontouchend = () => {
                    // We don't need to start here immediately because click will fire next and restart it?
                    // Wait, if it's a LONG press, click might NOT fire or we want it to hold.
                    // If long press, we pause. When release (touchend), we should resume.
                    startLocalTimer();
                };
            });
        }

        // Carousel Functions
        function moveCarousel(id, direction) {
            const container = document.getElementById('carousel-' + id);
            const images = container.getElementsByClassName('product-image');
            const dots = container.getElementsByClassName('carousel-dot');
            let activeIndex = 0;

            for (let i = 0; i < images.length; i++) {
                if (images[i].classList.contains('active')) {
                    activeIndex = i;
                    break;
                }
            }

            let newIndex = activeIndex + direction;
            if (newIndex < 0) newIndex = images.length - 1;
            if (newIndex >= images.length) newIndex = 0;

            setCarousel(id, newIndex);
        }

        function setCarousel(id, index) {
            const container = document.getElementById('carousel-' + id);
            const images = container.getElementsByClassName('product-image');
            const dots = container.getElementsByClassName('carousel-dot');

            for (let i = 0; i < images.length; i++) {
                images[i].classList.remove('active');
                if (dots[i]) dots[i].classList.remove('active');
            }

            images[index].classList.add('active');
            if (dots[index]) dots[index].classList.add('active');
        }

        function closeModal() { document.getElementById("modal").classList.remove("show"); }
    </script>

</body>

</html>